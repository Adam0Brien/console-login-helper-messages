# Manual - console-login-helper-messages

## Packages/subpackages

The following packages/subpackages provide the following functions:

| package                                | function |
| -------------------------------------- | --- |
| console-login-helper-messages          | base directory layout for this packge |
| console-login-helper-messages-issuegen | messages shown on serial console using issue (SSH keys, IP address for SSH) |
| console-login-helper-messages-motdgen  | messages shown using the motd paths after SSH in (system information) |
| console-login-helper-messages-profile  | messages shown using /etc/profile.d script, shown on login to bash terminal (failed systemd units) |

## Note on upstream dependencies

issuegen/motdgen rely on upstream features from packages such as PAM and agetty, to locate the issue/motd files and display them. The table below gives the earliest package version that the
needed features are given in.

| package                                      | fc28        | stable? | fc29        | stable? |
| -------------------------------------        | ----        | ------- | ----        | ------- |
| pam (for sshd which uses pam_motd.so)        | 1.3.1-15    |    Y    | 1.3.1-15    |    Y    |
| selinux-policy (permissions under /run)      | 3.14.3-14   |    N    | 3.14.3-14   |    N    |
| util-linux (aggetty to display /etc/issue.d) | 2.32-1      |    Y    | 2.32-1      |    Y    |

## Common operations

### Enabling messages

The following enables the `motd` and `issue` messages to show at boot:

```
systemctl enable issuegen.path issuegen.service motdgen.path motdgen.service
```

The `profile` messages are enabled by default by a symlink from `/etc/profile.d` at install.

### Appending messages

- To have a message appended to the same `motd` file generated by `motdgen.service`, the files to append can be dropped in `/etc/console-login-helper-messages/motd.d` or `/run/console-login-helper-messages/motd.d`
- Similarly, `issue` messages to append to the same `issue` file generated by `issuegen.service` can be dropped in `/etc/console-login-helper-messages/issue.d` or  or `/run/console-login-helper-messages/issue.d`

There is also functionality provided already in Fedora 28 and 29 by pam_motd.so [0] (used by sshd), and agetty [1],
which can accomplish displaying an additional message without needing to use the `console-login-helper-messages`
directories mentioned above.

- [0] https://www.mankier.com/8/pam_motd#Description
- [1] https://www.mankier.com/8/agetty#Issue_Files

### Disabling messages

The following disables the `motd` and `issue`  messages from showing:

```
systemctl disable issuegen.path issuegen.service motdgen.path motdgen.service
```

The `profile` messages can be disabled only by uninstalling `console-login-helper-messages-profile`.

#### Silencing a generated message without disabling

Messages can be silenced, but not disabled from being generated.

- The generated `motd` by `motdgen.service` may be silenced or overridden by placing a file at `/etc/motd.d/console-login-helper-messages.motd`. A symlink to `/dev/null` can also be used for silencing.
- Currently, the `issue` generated by `issuegen.service` can be silenced only by uninstalling `console-login-helper-messages-issuegen`.

### Recreating the symlinks

If a message is not showing, it could be because a symlink required to show the message was deleted. To recreate the symlinks, the following command can be used:

```
systemd-tmpfiles --create
```

### Regenerating the messages

To manually regenerate the `motd` or `issue`, the following commands can be used respectively:

```
systemctl restart motdgen.service
systemctl restart issuegen.service
```
